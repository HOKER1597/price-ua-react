{"ast":null,"code":"import _objectSpread from\"C:/Users/pushy/Desktop/Work/ek/price-ua/cosmetick-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useCallback,useMemo}from'react';import{useParams,useLocation,Link}from'react-router-dom';import axios from'axios';import'./ProductList.css';import{categoryNames}from'./Header.js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ProductList(_ref){var _appliedFilters$brand,_appliedFilters$price,_appliedFilters$volum,_appliedFilters$types,_appliedFilters$categ,_appliedFilters$categ2,_appliedFilters$brand2,_appliedFilters$price2,_appliedFilters$volum2,_appliedFilters$types2;let{searchTerm}=_ref;const{categoryId}=useParams();const location=useLocation();// Memoize queryParams and derived values to prevent unnecessary re-computation\nconst queryParams=useMemo(()=>new URLSearchParams(location.search),[location.search]);const searchQuery=useMemo(()=>queryParams.get('query')||queryParams.get('search')||searchTerm||'',[queryParams,searchTerm]);const initialType=useMemo(()=>queryParams.get('type')||'',[queryParams]);const isSearchPage=useMemo(()=>location.pathname==='/search',[location.pathname]);// Log initialization for debugging\nconsole.log('ProductList initialized with:',{categoryId,searchTerm,searchQuery,initialType,isSearchPage,location:location.pathname+location.search});// State for user and token to avoid localStorage re-parsing\nconst[user]=useState(()=>JSON.parse(localStorage.getItem('user'))||null);const[token]=useState(()=>localStorage.getItem('token')||null);// State for filters\nconst[filters,setFilters]=useState({brands:[],priceRanges:[],volumes:[],types:[],categories:[]});// State for selected filters\nconst[selectedFilters,setSelectedFilters]=useState({brands:[],priceRanges:[],volumes:[],types:initialType?[initialType]:[],categories:categoryId?[categoryId]:[]});// State for applied filters\nconst[appliedFilters,setAppliedFilters]=useState({brands:[],priceRanges:[],volumes:[],types:initialType?[initialType]:[],categories:categoryId?[categoryId]:[]});// State for products and pagination\nconst[allProducts,setAllProducts]=useState([]);const[filteredProducts,setFilteredProducts]=useState([]);const[totalProducts,setTotalProducts]=useState(0);const[previewProductCount,setPreviewProductCount]=useState(0);const[currentPage,setCurrentPage]=useState(1);const productsPerPage=24;const[isPaginated,setIsPaginated]=useState(true);const[startPage,setStartPage]=useState(1);const[loadMorePages,setLoadMorePages]=useState(1);// State for brand search\nconst[brandSearch,setBrandSearch]=useState('');// State for custom price range\nconst[customPriceFrom,setCustomPriceFrom]=useState('');const[customPriceTo,setCustomPriceTo]=useState('');// State for active filter\nconst[activeFilter,setActiveFilter]=useState(null);// State for disabled filters\nconst[disabledFilters,setDisabledFilters]=useState({brands:new Set(),priceRanges:new Set(),volumes:new Set(),types:new Set(),categories:new Set()});// State for \"Show More\"\nconst[showMore,setShowMore]=useState({brands:false,priceRanges:false,volumes:false,types:false,categories:false});// State for loading indicator\nconst[isLoading,setIsLoading]=useState(true);// State for saved products\nconst[savedProducts,setSavedProducts]=useState(new Set());// State for login prompt\nconst[showLoginPrompt,setShowLoginPrompt]=useState({});// Refs for filter positioning\nconst filterRefs=useRef({});const tagRef=useRef(null);const filterItemsRefs=useRef({});// Get minimum price from store_prices\nconst getMinPrice=storePrices=>{if(!storePrices||storePrices.length===0)return 0;return Math.min(...storePrices.map(sp=>sp.price));};// Handle heart click with optimistic update\nconst handleHeartClick=async(productId,event)=>{event.preventDefault();if(!user||!token){setShowLoginPrompt(prev=>_objectSpread(_objectSpread({},prev),{},{[productId]:true}));setTimeout(()=>{setShowLoginPrompt(prev=>_objectSpread(_objectSpread({},prev),{},{[productId]:false}));},3000);return;}const isSaved=savedProducts.has(productId);setSavedProducts(prev=>{const newSet=new Set(prev);if(isSaved){newSet.delete(productId);}else{newSet.add(productId);}return newSet;});try{if(isSaved){await axios.delete(\"https://price-ua-react-backend.onrender.com/saved-products/\".concat(productId),{headers:{Authorization:\"Bearer \".concat(token)}});}else{await axios.post('https://price-ua-react-backend.onrender.com/saved-products',{productId},{headers:{Authorization:\"Bearer \".concat(token)}});}}catch(error){setSavedProducts(prev=>{const newSet=new Set(prev);if(isSaved){newSet.add(productId);}else{newSet.delete(productId);}return newSet;});console.error('Помилка при зміні статусу збереження:',error);alert('Не вдалося оновити статус бажаного. Спробуйте ще раз.');}};// Calculate filtered products for preview and disabled filters\nconst calculateFilteredProducts=useCallback(tempFilters=>{let filtered=[...allProducts];if(searchQuery){filtered=filtered.filter(product=>product.name.toLowerCase().includes(searchQuery.toLowerCase()));}if(categoryId&&!isSearchPage){filtered=filtered.filter(product=>product.category_id===categoryId);}else if(tempFilters.categories.length>0&&isSearchPage){filtered=filtered.filter(product=>tempFilters.categories.includes(product.category_name));}if(tempFilters.brands.length>0){filtered=filtered.filter(product=>tempFilters.brands.includes(product.brand_name));}if(customPriceFrom!==''&&customPriceTo!==''){const priceFrom=parseFloat(customPriceFrom);const priceTo=parseFloat(customPriceTo);filtered=filtered.filter(product=>{const minPrice=getMinPrice(product.store_prices);return minPrice>=priceFrom&&minPrice<=priceTo;});}else if(tempFilters.priceRanges.length>0){filtered=filtered.filter(product=>{const minPrice=getMinPrice(product.store_prices);return tempFilters.priceRanges.some(range=>{const[min,max]=range.includes('+')?[1000,Infinity]:range.split('-').map(Number);return minPrice>=min&&(max===Infinity||minPrice<=max);});});}if(tempFilters.volumes.length>0){filtered=filtered.filter(product=>tempFilters.volumes.includes(product.volume));}if(tempFilters.types.length>0){filtered=filtered.filter(product=>tempFilters.types.includes(product.feature_type));}return filtered;},[allProducts,searchQuery,categoryId,isSearchPage,customPriceFrom,customPriceTo]);// Calculate preview product count\nconst calculatePreviewProducts=useCallback(()=>{const filtered=calculateFilteredProducts(selectedFilters);return filtered.length;},[calculateFilteredProducts,selectedFilters]);// Update disabled filters\nconst updateDisabledFilters=useCallback(()=>{const newDisabledFilters={brands:new Set(),priceRanges:new Set(),volumes:new Set(),types:new Set(),categories:new Set()};const baseFilters={brands:[...selectedFilters.brands],priceRanges:[...selectedFilters.priceRanges],volumes:[...selectedFilters.volumes],types:[...selectedFilters.types],categories:[...selectedFilters.categories]};filters.brands.forEach(brand=>{const tempFilters=_objectSpread(_objectSpread({},baseFilters),{},{brands:[brand],priceRanges:baseFilters.priceRanges,volumes:baseFilters.volumes,types:baseFilters.types,categories:baseFilters.categories});const filtered=calculateFilteredProducts(tempFilters);if(filtered.length===0)newDisabledFilters.brands.add(brand);});filters.priceRanges.forEach(range=>{const tempFilters=_objectSpread(_objectSpread({},baseFilters),{},{brands:baseFilters.brands,priceRanges:[range.label],volumes:baseFilters.volumes,types:baseFilters.types,categories:baseFilters.categories});const filtered=calculateFilteredProducts(tempFilters);if(filtered.length===0)newDisabledFilters.priceRanges.add(range.label);});filters.volumes.forEach(volume=>{const tempFilters=_objectSpread(_objectSpread({},baseFilters),{},{brands:baseFilters.brands,priceRanges:baseFilters.priceRanges,volumes:[volume],types:baseFilters.types,categories:baseFilters.categories});const filtered=calculateFilteredProducts(tempFilters);if(filtered.length===0)newDisabledFilters.volumes.add(volume);});filters.types.forEach(type=>{const tempFilters=_objectSpread(_objectSpread({},baseFilters),{},{brands:baseFilters.brands,priceRanges:baseFilters.priceRanges,volumes:baseFilters.volumes,types:[type],categories:baseFilters.categories});const filtered=calculateFilteredProducts(tempFilters);if(filtered.length===0)newDisabledFilters.types.add(type);});if(isSearchPage){filters.categories.forEach(category=>{const tempFilters=_objectSpread(_objectSpread({},baseFilters),{},{brands:baseFilters.brands,priceRanges:baseFilters.priceRanges,volumes:baseFilters.volumes,types:baseFilters.types,categories:[category]});const filtered=calculateFilteredProducts(tempFilters);if(filtered.length===0)newDisabledFilters.categories.add(category);});}setDisabledFilters(newDisabledFilters);},[filters,selectedFilters,calculateFilteredProducts,isSearchPage]);// Fetch products and saved statuses\nuseEffect(()=>{console.log('useEffect triggered with dependencies:',{categoryId,searchQuery,initialType,isSearchPage,user:user?user.id:null,token:token?'present':'absent'});const fetchProducts=async()=>{setIsLoading(true);try{const requestParams={search:searchQuery||undefined,category:categoryId&&!isSearchPage?categoryId:undefined,limit:1000};console.log('Fetching products with params:',requestParams);const productsResponse=await axios.get('https://price-ua-react-backend.onrender.com/products',{params:requestParams});console.log('Products API response:',{productCount:productsResponse.data.products.length,products:productsResponse.data.products.map(p=>({id:p.id,name:p.name,category_id:p.category_id,category_name:p.category_name}))});let productsData=productsResponse.data.products||[];let savedProductIds=[];if(user&&token&&productsData.length>0){const productIds=productsData.map(p=>p.id);try{const savedResponse=await axios.post('https://price-ua-react-backend.onrender.com/saved-products/bulk',{productIds},{headers:{Authorization:\"Bearer \".concat(token)}});savedProductIds=savedResponse.data.savedProductIds||[];console.log('Saved products response:',{savedProductIds});}catch(error){console.error('Помилка завантаження статусів збереження:',error);}}setSavedProducts(new Set(savedProductIds));const brandCounts={};const typeCounts={};const categoryCounts={};const allVolumes=new Set();const priceBuckets=new Set();productsData.forEach(product=>{const brand=product.brand_name;const type=product.feature_type;const category=product.category_name;const volume=product.volume;const minPrice=getMinPrice(product.store_prices);brandCounts[brand]=(brandCounts[brand]||0)+1;if(type)typeCounts[type]=(typeCounts[type]||0)+1;categoryCounts[category]=(categoryCounts[category]||0)+1;if(volume)allVolumes.add(volume);if(minPrice>0){if(minPrice<=100)priceBuckets.add('0-100');else if(minPrice<=200)priceBuckets.add('100-200');else if(minPrice<=300)priceBuckets.add('200-300');else if(minPrice<=400)priceBuckets.add('300-400');else if(minPrice<=500)priceBuckets.add('400-500');else if(minPrice<=600)priceBuckets.add('500-600');else if(minPrice<=700)priceBuckets.add('600-700');else if(minPrice<=800)priceBuckets.add('700-800');else if(minPrice<=900)priceBuckets.add('800-900');else if(minPrice<=1000)priceBuckets.add('900-1000');else priceBuckets.add('1000+');}});const allBrands=[...new Set(productsData.map(p=>p.brand_name))].sort((a,b)=>(brandCounts[b]||0)-(brandCounts[a]||0));const allPriceRanges=[{label:'0-100',min:0,max:100},{label:'100-200',min:100,max:200},{label:'200-300',min:200,max:300},{label:'300-400',min:300,max:400},{label:'400-500',min:400,max:500},{label:'500-600',min:500,max:600},{label:'600-700',min:600,max:700},{label:'700-800',min:700,max:800},{label:'800-900',min:800,max:900},{label:'900-1000',min:900,max:1000},{label:'1000+',min:1000,max:Infinity}].filter(range=>priceBuckets.has(range.label));const allVolumesSorted=[...allVolumes].sort((a,b)=>{const numA=parseFloat(a.replace(/[^0-9.]/g,''))||0;const numB=parseFloat(b.replace(/[^0-9.]/g,''))||0;return numA-numB;});const allTypes=[...new Set(productsData.map(p=>p.feature_type).filter(Boolean))].sort((a,b)=>(typeCounts[b]||0)-(typeCounts[a]||0));const allCategories=isSearchPage?[...new Set(productsData.map(p=>p.category_name))].sort((a,b)=>(categoryCounts[b]||0)-(categoryCounts[a]||0)):[categoryId].filter(Boolean);setFilters({brands:allBrands,priceRanges:allPriceRanges,volumes:allVolumesSorted,types:allTypes,categories:allCategories});setAllProducts(productsData);setFilteredProducts(productsData);setTotalProducts(productsData.length);setPreviewProductCount(productsData.length);setCurrentPage(1);setStartPage(1);setLoadMorePages(1);setIsPaginated(true);setSelectedFilters({brands:[],priceRanges:[],volumes:[],types:initialType?[initialType]:[],categories:categoryId?[categoryId]:[]});setAppliedFilters({brands:[],priceRanges:[],volumes:[],types:initialType?[initialType]:[],categories:categoryId?[categoryId]:[]});setBrandSearch('');setCustomPriceFrom('');setCustomPriceTo('');setDisabledFilters({brands:new Set(),priceRanges:new Set(),volumes:new Set(),types:new Set(),categories:new Set()});if(initialType){setTimeout(()=>{const typeCheckbox=document.querySelector(\"input[name=\\\"type\\\"][value=\\\"\".concat(initialType,\"\\\"]\"));if(typeCheckbox)typeCheckbox.checked=true;},0);}}catch(error){console.error('Помилка завантаження продуктів:',error);alert('Не вдалося завантажити продукти. Перевірте підключення до сервера.');setAllProducts([]);setFilteredProducts([]);setTotalProducts(0);setPreviewProductCount(0);setSavedProducts(new Set());}finally{setIsLoading(false);}};fetchProducts();},[categoryId,searchQuery,initialType,isSearchPage,token]);// Removed user from dependencies\n// Update preview count and disabled filters\nuseEffect(()=>{if(!isLoading){setPreviewProductCount(calculatePreviewProducts());updateDisabledFilters();}},[selectedFilters,customPriceFrom,customPriceTo,isLoading,calculatePreviewProducts,updateDisabledFilters]);// Client-side filtering\nuseEffect(()=>{if(!isLoading&&allProducts.length>0){console.log('Starting client-side filtering:',{allProductsCount:allProducts.length,searchQuery,categoryId,isSearchPage,appliedFilters,customPriceFrom,customPriceTo});let filtered=[...allProducts];if(searchQuery){filtered=filtered.filter(product=>product.name.toLowerCase().includes(searchQuery.toLowerCase()));}if(categoryId&&!isSearchPage){filtered=filtered.filter(product=>product.category_id===categoryId);}else if(appliedFilters.categories.length>0&&isSearchPage){filtered=filtered.filter(product=>appliedFilters.categories.includes(product.category_name));}if(appliedFilters.brands.length>0){filtered=filtered.filter(product=>appliedFilters.brands.includes(product.brand_name));}if(customPriceFrom!==''&&customPriceTo!==''){const priceFrom=parseFloat(customPriceFrom);const priceTo=parseFloat(customPriceTo);filtered=filtered.filter(product=>{const minPrice=getMinPrice(product.store_prices);return minPrice>=priceFrom&&minPrice<=priceTo;});}else if(appliedFilters.priceRanges.length>0){filtered=filtered.filter(product=>{const minPrice=getMinPrice(product.store_prices);return appliedFilters.priceRanges.some(range=>{const[min,max]=range.includes('+')?[1000,Infinity]:range.split('-').map(Number);return minPrice>=min&&(max===Infinity||minPrice<=max);});});}if(appliedFilters.volumes.length>0){filtered=filtered.filter(product=>appliedFilters.volumes.includes(product.volume));}if(appliedFilters.types.length>0){filtered=filtered.filter(product=>appliedFilters.types.includes(product.feature_type));}setFilteredProducts(filtered);setTotalProducts(filtered.length);}},[allProducts,appliedFilters,customPriceFrom,customPriceTo,searchQuery,categoryId,isSearchPage,isLoading]);// Handle filter change\nconst handleFilterChange=(filterType,value)=>{setSelectedFilters(prev=>{const currentValues=prev[filterType]||[];let updatedValues;if(currentValues.includes(value)){updatedValues=currentValues.filter(v=>v!==value);}else{updatedValues=[...currentValues,value];}const updatedFilters=_objectSpread(_objectSpread({},prev),{},{[filterType]:updatedValues});if(filterType==='priceRanges'){setCustomPriceFrom('');setCustomPriceTo('');}return updatedFilters;});setActiveFilter({type:filterType,value});};// Remove a filter\nconst removeFilter=(filterType,value)=>{setSelectedFilters(prev=>{const updatedValues=(prev[filterType]||[]).filter(v=>v!==value);const updatedFilters=_objectSpread(_objectSpread({},prev),{},{[filterType]:updatedValues});setAppliedFilters(_objectSpread(_objectSpread({},prev),{},{[filterType]:updatedValues}));return updatedFilters;});};// Reset all filters\nconst resetAllFilters=()=>{const emptyFilters={brands:[],priceRanges:[],volumes:[],types:[],categories:[]};setSelectedFilters(emptyFilters);setAppliedFilters(emptyFilters);setBrandSearch('');setCustomPriceFrom('');setCustomPriceTo('');setDisabledFilters({brands:new Set(),priceRanges:new Set(),volumes:new Set(),types:new Set(),categories:new Set()});setCurrentPage(1);setStartPage(1);setLoadMorePages(1);setIsPaginated(true);};// Apply filters\nconst applyFilters=()=>{setAppliedFilters(_objectSpread({},selectedFilters));setCurrentPage(1);setStartPage(1);setLoadMorePages(1);setIsPaginated(true);setActiveFilter(null);};// Toggle show more\nconst toggleShowMore=filterType=>{setShowMore(prev=>_objectSpread(_objectSpread({},prev),{},{[filterType]:!prev[filterType]}));};// Handle brand search\nconst handleBrandSearch=e=>{setBrandSearch(e.target.value);};// Handle custom price change\nconst handleCustomPriceChange=(field,value)=>{const numValue=value.replace(/[^0-9]/g,'');if(field==='from'){setCustomPriceFrom(numValue);}else{setCustomPriceTo(numValue);}if(numValue!==''){setSelectedFilters(prev=>_objectSpread(_objectSpread({},prev),{},{priceRanges:[]}));setAppliedFilters(prev=>_objectSpread(_objectSpread({},prev),{},{priceRanges:[]}));}};// Get visible filter items\nconst getVisibleItems=useCallback((items,filterType)=>{if(!items)return[];let filteredItems=items;if(filterType==='brands'){filteredItems=items.filter(brand=>brand.toLowerCase().includes(brandSearch.toLowerCase()));const topItems=filteredItems.slice(0,12);const remainingItems=filteredItems.slice(12);if(showMore.brands||filteredItems.length<=12){return[...topItems,...remainingItems.sort((a,b)=>a.localeCompare(b))];}return topItems;}if(filterType==='types'){const topItems=filteredItems.slice(0,6);const remainingItems=filteredItems.slice(6);if(showMore.types||filteredItems.length<=6){return[...topItems,...remainingItems.sort((a,b)=>a.localeCompare(b))];}return topItems;}if(filterType==='categories'){if(showMore.categories||items.length<=6){return[...items].sort((a,b)=>a.localeCompare(b));}return items.slice(0,6);}if(showMore[filterType]||items.length<=12){return items;}return items.slice(0,12);},[brandSearch,showMore]);// Get product name\nconst getProductName=product=>{return\"\".concat(product.name,\" (\").concat(product.volume||'Об’єм не вказано',\")\");};// Pagination\nconst totalPages=Math.ceil(totalProducts/productsPerPage);const handlePageChange=page=>{setCurrentPage(page);setStartPage(page);setLoadMorePages(1);setIsPaginated(true);window.scrollTo({top:0,behavior:'smooth'});};const handleLoadMore=()=>{setCurrentPage(prev=>prev+1);setLoadMorePages(prev=>prev+1);setIsPaginated(false);};const pageNumbers=[];for(let i=1;i<=totalPages;i++){pageNumbers.push(i);}const totalAppliedFilters=(((_appliedFilters$brand=appliedFilters.brands)===null||_appliedFilters$brand===void 0?void 0:_appliedFilters$brand.length)||0)+(((_appliedFilters$price=appliedFilters.priceRanges)===null||_appliedFilters$price===void 0?void 0:_appliedFilters$price.length)||0)+(((_appliedFilters$volum=appliedFilters.volumes)===null||_appliedFilters$volum===void 0?void 0:_appliedFilters$volum.length)||0)+(((_appliedFilters$types=appliedFilters.types)===null||_appliedFilters$types===void 0?void 0:_appliedFilters$types.length)||0)+(isSearchPage?((_appliedFilters$categ=appliedFilters.categories)===null||_appliedFilters$categ===void 0?void 0:_appliedFilters$categ.length)||0:0)+(customPriceFrom!==''&&customPriceTo!==''?1:0);// Update filter container heights\nuseEffect(()=>{Object.keys(showMore).forEach(filterType=>{const container=filterItemsRefs.current[filterType];if(container){const items=container.querySelector('.filter-items');if(items){const visibleItems=getVisibleItems(filters[filterType],filterType);const maxVisible=filterType==='brands'||filterType==='priceRanges'||filterType==='volumes'?12:6;const isExpanded=showMore[filterType]||visibleItems.length<=maxVisible;const collapsedHeight=visibleItems.length>maxVisible?items.scrollHeight*(maxVisible/filters[filterType].length):items.scrollHeight;container.style.maxHeight=isExpanded?\"\".concat(items.scrollHeight,\"px\"):\"\".concat(collapsedHeight,\"px\");}}});},[showMore,filters,brandSearch,getVisibleItems]);return/*#__PURE__*/_jsxs(\"div\",{className:\"product-list\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0422\\u043E\\u0432\\u0430\\u0440\\u0438 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0456\\u0457\"}),isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"spinner-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0435\\u043D\\u043D\\u044F...\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-list-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filters \".concat(!isLoading?'loaded':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filters-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0424\\u0456\\u043B\\u044C\\u0442\\u0440\\u0438\"}),totalAppliedFilters>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"selected-filters\",children:[isSearchPage&&((_appliedFilters$categ2=appliedFilters.categories)===null||_appliedFilters$categ2===void 0?void 0:_appliedFilters$categ2.map(category=>/*#__PURE__*/_jsxs(\"div\",{className:\"selected-filter-tag\",children:[/*#__PURE__*/_jsx(\"span\",{children:categoryNames[category]||category}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFilter('categories',category),children:\"\\xD7\"})]},\"category-\".concat(category)))),(_appliedFilters$brand2=appliedFilters.brands)===null||_appliedFilters$brand2===void 0?void 0:_appliedFilters$brand2.map(brand=>/*#__PURE__*/_jsxs(\"div\",{className:\"selected-filter-tag\",children:[/*#__PURE__*/_jsx(\"span\",{children:brand}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFilter('brands',brand),children:\"\\xD7\"})]},\"brand-\".concat(brand))),customPriceFrom!==''&&customPriceTo!==''?/*#__PURE__*/_jsxs(\"div\",{className:\"selected-filter-tag\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[customPriceFrom,\"-\",customPriceTo,\" \\u0433\\u0440\\u043D\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setCustomPriceFrom('');setCustomPriceTo('');applyFilters();},children:\"\\xD7\"})]},\"custom-price\"):(_appliedFilters$price2=appliedFilters.priceRanges)===null||_appliedFilters$price2===void 0?void 0:_appliedFilters$price2.map(range=>/*#__PURE__*/_jsxs(\"div\",{className:\"selected-filter-tag\",children:[/*#__PURE__*/_jsx(\"span\",{children:range}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFilter('priceRanges',range),children:\"\\xD7\"})]},\"price-\".concat(range))),(_appliedFilters$volum2=appliedFilters.volumes)===null||_appliedFilters$volum2===void 0?void 0:_appliedFilters$volum2.map(volume=>/*#__PURE__*/_jsxs(\"div\",{className:\"selected-filter-tag\",children:[/*#__PURE__*/_jsx(\"span\",{children:volume}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFilter('volumes',volume),children:\"\\xD7\"})]},\"volume-\".concat(volume))),(_appliedFilters$types2=appliedFilters.types)===null||_appliedFilters$types2===void 0?void 0:_appliedFilters$types2.map(type=>/*#__PURE__*/_jsxs(\"div\",{className:\"selected-filter-tag\",children:[/*#__PURE__*/_jsx(\"span\",{children:type}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFilter('types',type),children:\"\\xD7\"})]},\"type-\".concat(type))),totalAppliedFilters>1&&/*#__PURE__*/_jsx(\"button\",{className:\"reset-all-filters\",onClick:resetAllFilters,children:\"\\u0421\\u043A\\u0438\\u043D\\u0443\\u0442\\u0438 \\u0432\\u0441\\u0456\"})]})]}),isSearchPage&&searchQuery&&/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0456\\u044F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"filter-items-container\",ref:el=>filterItemsRefs.current['categories']=el,children:/*#__PURE__*/_jsx(\"div\",{className:\"filter-items filter-items-single-column\",children:getVisibleItems(filters.categories,'categories').map((category,index)=>{var _selectedFilters$cate;const isDisabled=disabledFilters.categories.has(category);return/*#__PURE__*/_jsxs(\"label\",{className:isDisabled?'disabled':'',ref:el=>filterRefs.current[\"categories-\".concat(category)]=el,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"category\",value:category,checked:((_selectedFilters$cate=selectedFilters.categories)===null||_selectedFilters$cate===void 0?void 0:_selectedFilters$cate.includes(category))||false,onChange:()=>handleFilterChange('categories',category),disabled:isDisabled}),categoryNames[category]||category]},index);})})}),filters.categories.length>6&&/*#__PURE__*/_jsx(\"button\",{className:\"show-more-btn\",onClick:()=>toggleShowMore('categories'),children:showMore.categories?'Менше ↑':'Більше ↓'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u0411\\u0440\\u0435\\u043D\\u0434\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"brand-search-input\",placeholder:\"\\u041F\\u043E\\u0448\\u0443\\u043A \\u0431\\u0440\\u0435\\u043D\\u0434\\u0443...\",value:brandSearch,onChange:handleBrandSearch}),/*#__PURE__*/_jsx(\"div\",{className:\"filter-items-container\",ref:el=>filterItemsRefs.current['brands']=el,children:/*#__PURE__*/_jsx(\"div\",{className:\"filter-items\",children:getVisibleItems(filters.brands,'brands').map((brand,index)=>{var _selectedFilters$bran;const isDisabled=disabledFilters.brands.has(brand);return/*#__PURE__*/_jsxs(\"label\",{className:\"\".concat(brand.length>13?'span-two-columns':'',\" \").concat(isDisabled?'disabled':''),ref:el=>filterRefs.current[\"brands-\".concat(brand)]=el,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"brand\",value:brand,checked:((_selectedFilters$bran=selectedFilters.brands)===null||_selectedFilters$bran===void 0?void 0:_selectedFilters$bran.includes(brand))||false,onChange:()=>handleFilterChange('brands',brand),disabled:isDisabled}),brand]},index);})})}),filters.brands.length>12&&/*#__PURE__*/_jsx(\"button\",{className:\"show-more-btn\",onClick:()=>toggleShowMore('brands'),children:showMore.brands?'Менше ↑':'Більше ↓'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u0426\\u0456\\u043D\\u0430 (\\u0433\\u0440\\u043D)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-price-inputs\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0412\\u0456\\u0434\",value:customPriceFrom,onChange:e=>handleCustomPriceChange('from',e.target.value),className:\"price-input\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0414\\u043E\",value:customPriceTo,onChange:e=>handleCustomPriceChange('to',e.target.value),className:\"price-input\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"filter-items-container\",ref:el=>filterItemsRefs.current['priceRanges']=el,children:/*#__PURE__*/_jsx(\"div\",{className:\"filter-items\",children:getVisibleItems(filters.priceRanges,'priceRanges').map((range,index)=>{var _selectedFilters$pric;const isDisabled=disabledFilters.priceRanges.has(range.label);return/*#__PURE__*/_jsxs(\"label\",{className:isDisabled?'disabled':'',ref:el=>filterRefs.current[\"priceRanges-\".concat(range.label)]=el,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"priceRange\",value:range.label,checked:((_selectedFilters$pric=selectedFilters.priceRanges)===null||_selectedFilters$pric===void 0?void 0:_selectedFilters$pric.includes(range.label))||false,onChange:()=>handleFilterChange('priceRanges',range.label),disabled:isDisabled}),range.label]},index);})})}),filters.priceRanges.length>12&&/*#__PURE__*/_jsx(\"button\",{className:\"show-more-btn\",onClick:()=>toggleShowMore('priceRanges'),children:showMore.priceRanges?'Менше ↑':'Більше ↓'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u041E\\u0431\\u2019\\u0454\\u043C\"}),/*#__PURE__*/_jsx(\"div\",{className:\"filter-items-container\",ref:el=>filterItemsRefs.current['volumes']=el,children:/*#__PURE__*/_jsx(\"div\",{className:\"filter-items\",children:getVisibleItems(filters.volumes,'volumes').map((volume,index)=>{var _selectedFilters$volu;const isDisabled=disabledFilters.volumes.has(volume);return/*#__PURE__*/_jsxs(\"label\",{className:isDisabled?'disabled':'',ref:el=>filterRefs.current[\"volumes-\".concat(volume)]=el,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"volume\",value:volume,checked:((_selectedFilters$volu=selectedFilters.volumes)===null||_selectedFilters$volu===void 0?void 0:_selectedFilters$volu.includes(volume))||false,onChange:()=>handleFilterChange('volumes',volume),disabled:isDisabled}),volume]},index);})})}),filters.volumes.length>12&&/*#__PURE__*/_jsx(\"button\",{className:\"show-more-btn\",onClick:()=>toggleShowMore('volumes'),children:showMore.volumes?'Менше ↑':'Більше ↓'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u0422\\u0438\\u043F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"filter-items-container\",ref:el=>filterItemsRefs.current['types']=el,children:/*#__PURE__*/_jsx(\"div\",{className:\"filter-items filter-items-single-column\",children:getVisibleItems(filters.types,'types').map((type,index)=>{var _selectedFilters$type;const isDisabled=disabledFilters.types.has(type);return/*#__PURE__*/_jsxs(\"label\",{className:isDisabled?'disabled':'',ref:el=>filterRefs.current[\"types-\".concat(type)]=el,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"type\",value:type,checked:((_selectedFilters$type=selectedFilters.types)===null||_selectedFilters$type===void 0?void 0:_selectedFilters$type.includes(type))||false,onChange:()=>handleFilterChange('types',type),disabled:isDisabled}),type]},index);})})}),filters.types.length>6&&/*#__PURE__*/_jsx(\"button\",{className:\"show-more-btn\",onClick:()=>toggleShowMore('types'),children:showMore.types?'Менше ↑':'Більше ↓'})]}),activeFilter&&/*#__PURE__*/_jsxs(\"button\",{className:\"filter-tag\",ref:tagRef,onClick:applyFilters,style:{top:filterRefs.current[\"\".concat(activeFilter.type,\"-\").concat(activeFilter.value)]?\"\".concat(filterRefs.current[\"\".concat(activeFilter.type,\"-\").concat(activeFilter.value)].getBoundingClientRect().top-filterRefs.current[\"\".concat(activeFilter.type,\"-\").concat(activeFilter.value)].closest('.filters').getBoundingClientRect().top+filterRefs.current[\"\".concat(activeFilter.type,\"-\").concat(activeFilter.value)].offsetHeight/2,\"px\"):'0px'},children:[\"\\u041F\\u043E\\u043A\\u0430\\u0437\\u0430\\u0442\\u0438 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0438 (\",previewProductCount,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"apply-filters-btn\",onClick:applyFilters,children:[\"\\u041F\\u043E\\u043A\\u0430\\u0437\\u0430\\u0442\\u0438 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0438 (\",previewProductCount,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"products\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"products-list \".concat(!isLoading?'loaded':''),children:filteredProducts.length>0?filteredProducts.slice(isPaginated?(currentPage-1)*productsPerPage:(startPage-1)*productsPerPage,isPaginated?currentPage*productsPerPage:startPage*productsPerPage+loadMorePages*productsPerPage).map((product,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"product-card-container\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/product/\".concat(product.id),className:\"product-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:getProductName(product)}),/*#__PURE__*/_jsx(\"img\",{src:product.images&&product.images.length>0?product.images[0]:'/img/placeholder.webp',alt:product.name,onError:e=>e.target.src='/img/placeholder.webp'}),/*#__PURE__*/_jsxs(\"p\",{className:\"price\",children:[getMinPrice(product.store_prices),\" \\u0433\\u0440\\u043D\"]}),/*#__PURE__*/_jsx(\"p\",{children:product.description||'Опис відсутній'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"heart-icon \".concat(savedProducts.has(product.id)?'saved':''),onClick:e=>handleHeartClick(product.id,e),children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:savedProducts.has(product.id)?'#d32f2f':'none',stroke:\"#d32f2f\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z\"})})}),showLoginPrompt[product.id]&&/*#__PURE__*/_jsxs(\"div\",{className:\"login-prompt\",children:[\"\\u0423\\u0432\\u0456\\u0439\\u0434\\u0456\\u0442\\u044C \\u0432 \",/*#__PURE__*/_jsx(Link,{to:\"/login\",className:\"login-link\",children:\"\\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\"}),\" \\u0449\\u043E\\u0431 \\u0434\\u043E\\u0434\\u0430\\u0442\\u0438 \\u0434\\u043E \\u0431\\u0430\\u0436\\u0430\\u043D\\u043E\\u0433\\u043E\"]})]},\"\".concat(product.id,\"-\").concat(index))):!isLoading&&/*#__PURE__*/_jsx(\"p\",{children:\"\\u0422\\u043E\\u0432\\u0430\\u0440\\u0438 \\u043D\\u0435 \\u0437\\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"})}),!isLoading&&totalProducts>productsPerPage&&/*#__PURE__*/_jsxs(\"div\",{className:\"pagination-container\",children:[(startPage-1+loadMorePages)*productsPerPage<totalProducts&&/*#__PURE__*/_jsx(\"button\",{className:\"load-more-btn\",onClick:handleLoadMore,children:\"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0438\\u0442\\u0438 \\u0449\\u0435\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pagination\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"pagination-btn\",onClick:()=>handlePageChange(currentPage-1),disabled:currentPage===1,children:\"\\u041F\\u043E\\u043F\\u0435\\u0440\\u0435\\u0434\\u043D\\u044F\"}),pageNumbers.map(number=>/*#__PURE__*/_jsx(\"button\",{className:\"pagination-btn \".concat(currentPage===number?'active':''),onClick:()=>handlePageChange(number),children:number},number)),/*#__PURE__*/_jsx(\"button\",{className:\"pagination-btn\",onClick:()=>handlePageChange(currentPage+1),disabled:currentPage===totalPages,children:\"\\u041D\\u0430\\u0441\\u0442\\u0443\\u043F\\u043D\\u0430\"})]})]})]})]})]});}export default ProductList;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useMemo","useParams","useLocation","Link","axios","categoryNames","jsx","_jsx","jsxs","_jsxs","ProductList","_ref","_appliedFilters$brand","_appliedFilters$price","_appliedFilters$volum","_appliedFilters$types","_appliedFilters$categ","_appliedFilters$categ2","_appliedFilters$brand2","_appliedFilters$price2","_appliedFilters$volum2","_appliedFilters$types2","searchTerm","categoryId","location","queryParams","URLSearchParams","search","searchQuery","get","initialType","isSearchPage","pathname","console","log","user","JSON","parse","localStorage","getItem","token","filters","setFilters","brands","priceRanges","volumes","types","categories","selectedFilters","setSelectedFilters","appliedFilters","setAppliedFilters","allProducts","setAllProducts","filteredProducts","setFilteredProducts","totalProducts","setTotalProducts","previewProductCount","setPreviewProductCount","currentPage","setCurrentPage","productsPerPage","isPaginated","setIsPaginated","startPage","setStartPage","loadMorePages","setLoadMorePages","brandSearch","setBrandSearch","customPriceFrom","setCustomPriceFrom","customPriceTo","setCustomPriceTo","activeFilter","setActiveFilter","disabledFilters","setDisabledFilters","Set","showMore","setShowMore","isLoading","setIsLoading","savedProducts","setSavedProducts","showLoginPrompt","setShowLoginPrompt","filterRefs","tagRef","filterItemsRefs","getMinPrice","storePrices","length","Math","min","map","sp","price","handleHeartClick","productId","event","preventDefault","prev","_objectSpread","setTimeout","isSaved","has","newSet","delete","add","concat","headers","Authorization","post","error","alert","calculateFilteredProducts","tempFilters","filtered","filter","product","name","toLowerCase","includes","category_id","category_name","brand_name","priceFrom","parseFloat","priceTo","minPrice","store_prices","some","range","max","Infinity","split","Number","volume","feature_type","calculatePreviewProducts","updateDisabledFilters","newDisabledFilters","baseFilters","forEach","brand","label","type","category","id","fetchProducts","requestParams","undefined","limit","productsResponse","params","productCount","data","products","p","productsData","savedProductIds","productIds","savedResponse","brandCounts","typeCounts","categoryCounts","allVolumes","priceBuckets","allBrands","sort","a","b","allPriceRanges","allVolumesSorted","numA","replace","numB","allTypes","Boolean","allCategories","typeCheckbox","document","querySelector","checked","allProductsCount","handleFilterChange","filterType","value","currentValues","updatedValues","v","updatedFilters","removeFilter","resetAllFilters","emptyFilters","applyFilters","toggleShowMore","handleBrandSearch","e","target","handleCustomPriceChange","field","numValue","getVisibleItems","items","filteredItems","topItems","slice","remainingItems","localeCompare","getProductName","totalPages","ceil","handlePageChange","page","window","scrollTo","top","behavior","handleLoadMore","pageNumbers","i","push","totalAppliedFilters","Object","keys","container","current","visibleItems","maxVisible","isExpanded","collapsedHeight","scrollHeight","style","maxHeight","className","children","onClick","ref","el","index","_selectedFilters$cate","isDisabled","onChange","disabled","placeholder","_selectedFilters$bran","_selectedFilters$pric","_selectedFilters$volu","_selectedFilters$type","getBoundingClientRect","closest","offsetHeight","to","src","images","alt","onError","description","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","number"],"sources":["C:/Users/pushy/Desktop/Work/ek/price-ua/cosmetick-frontend/src/components/ProductList.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\r\nimport { useParams, useLocation, Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport './ProductList.css';\r\nimport { categoryNames } from './Header.js';\r\n\r\nfunction ProductList({ searchTerm }) {\r\n  const { categoryId } = useParams();\r\n  const location = useLocation();\r\n\r\n  // Memoize queryParams and derived values to prevent unnecessary re-computation\r\n  const queryParams = useMemo(() => new URLSearchParams(location.search), [location.search]);\r\n  const searchQuery = useMemo(\r\n    () => queryParams.get('query') || queryParams.get('search') || searchTerm || '',\r\n    [queryParams, searchTerm]\r\n  );\r\n  const initialType = useMemo(() => queryParams.get('type') || '', [queryParams]);\r\n  const isSearchPage = useMemo(() => location.pathname === '/search', [location.pathname]);\r\n\r\n  // Log initialization for debugging\r\n  console.log('ProductList initialized with:', {\r\n    categoryId,\r\n    searchTerm,\r\n    searchQuery,\r\n    initialType,\r\n    isSearchPage,\r\n    location: location.pathname + location.search,\r\n  });\r\n\r\n  // State for user and token to avoid localStorage re-parsing\r\n  const [user] = useState(() => JSON.parse(localStorage.getItem('user')) || null);\r\n  const [token] = useState(() => localStorage.getItem('token') || null);\r\n\r\n  // State for filters\r\n  const [filters, setFilters] = useState({\r\n    brands: [],\r\n    priceRanges: [],\r\n    volumes: [],\r\n    types: [],\r\n    categories: [],\r\n  });\r\n\r\n  // State for selected filters\r\n  const [selectedFilters, setSelectedFilters] = useState({\r\n    brands: [],\r\n    priceRanges: [],\r\n    volumes: [],\r\n    types: initialType ? [initialType] : [],\r\n    categories: categoryId ? [categoryId] : [],\r\n  });\r\n\r\n  // State for applied filters\r\n  const [appliedFilters, setAppliedFilters] = useState({\r\n    brands: [],\r\n    priceRanges: [],\r\n    volumes: [],\r\n    types: initialType ? [initialType] : [],\r\n    categories: categoryId ? [categoryId] : [],\r\n  });\r\n\r\n  // State for products and pagination\r\n  const [allProducts, setAllProducts] = useState([]);\r\n  const [filteredProducts, setFilteredProducts] = useState([]);\r\n  const [totalProducts, setTotalProducts] = useState(0);\r\n  const [previewProductCount, setPreviewProductCount] = useState(0);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const productsPerPage = 24;\r\n  const [isPaginated, setIsPaginated] = useState(true);\r\n  const [startPage, setStartPage] = useState(1);\r\n  const [loadMorePages, setLoadMorePages] = useState(1);\r\n  \r\n\r\n  // State for brand search\r\n  const [brandSearch, setBrandSearch] = useState('');\r\n\r\n  // State for custom price range\r\n  const [customPriceFrom, setCustomPriceFrom] = useState('');\r\n  const [customPriceTo, setCustomPriceTo] = useState('');\r\n\r\n  // State for active filter\r\n  const [activeFilter, setActiveFilter] = useState(null);\r\n\r\n  // State for disabled filters\r\n  const [disabledFilters, setDisabledFilters] = useState({\r\n    brands: new Set(),\r\n    priceRanges: new Set(),\r\n    volumes: new Set(),\r\n    types: new Set(),\r\n    categories: new Set(),\r\n  });\r\n\r\n  // State for \"Show More\"\r\n  const [showMore, setShowMore] = useState({\r\n    brands: false,\r\n    priceRanges: false,\r\n    volumes: false,\r\n    types: false,\r\n    categories: false,\r\n  });\r\n\r\n  // State for loading indicator\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  // State for saved products\r\n  const [savedProducts, setSavedProducts] = useState(new Set());\r\n\r\n  // State for login prompt\r\n  const [showLoginPrompt, setShowLoginPrompt] = useState({});\r\n\r\n  // Refs for filter positioning\r\n  const filterRefs = useRef({});\r\n  const tagRef = useRef(null);\r\n  const filterItemsRefs = useRef({});\r\n\r\n  // Get minimum price from store_prices\r\n  const getMinPrice = (storePrices) => {\r\n    if (!storePrices || storePrices.length === 0) return 0;\r\n    return Math.min(...storePrices.map(sp => sp.price));\r\n  };\r\n\r\n  // Handle heart click with optimistic update\r\n  const handleHeartClick = async (productId, event) => {\r\n    event.preventDefault();\r\n    if (!user || !token) {\r\n      setShowLoginPrompt(prev => ({ ...prev, [productId]: true }));\r\n      setTimeout(() => {\r\n        setShowLoginPrompt(prev => ({ ...prev, [productId]: false }));\r\n      }, 3000);\r\n      return;\r\n    }\r\n\r\n    const isSaved = savedProducts.has(productId);\r\n    setSavedProducts(prev => {\r\n      const newSet = new Set(prev);\r\n      if (isSaved) {\r\n        newSet.delete(productId);\r\n      } else {\r\n        newSet.add(productId);\r\n      }\r\n      return newSet;\r\n    });\r\n\r\n    try {\r\n      if (isSaved) {\r\n        await axios.delete(`https://price-ua-react-backend.onrender.com/saved-products/${productId}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n      } else {\r\n        await axios.post(\r\n          'https://price-ua-react-backend.onrender.com/saved-products',\r\n          { productId },\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n      }\r\n    } catch (error) {\r\n      setSavedProducts(prev => {\r\n        const newSet = new Set(prev);\r\n        if (isSaved) {\r\n          newSet.add(productId);\r\n        } else {\r\n          newSet.delete(productId);\r\n        }\r\n        return newSet;\r\n      });\r\n      console.error('Помилка при зміні статусу збереження:', error);\r\n      alert('Не вдалося оновити статус бажаного. Спробуйте ще раз.');\r\n    }\r\n  };\r\n\r\n  // Calculate filtered products for preview and disabled filters\r\n  const calculateFilteredProducts = useCallback((tempFilters) => {\r\n    let filtered = [...allProducts];\r\n\r\n    if (searchQuery) {\r\n      filtered = filtered.filter(product =>\r\n        product.name.toLowerCase().includes(searchQuery.toLowerCase())\r\n      );\r\n    }\r\n\r\n    if (categoryId && !isSearchPage) {\r\n      filtered = filtered.filter(product => product.category_id === categoryId);\r\n    } else if (tempFilters.categories.length > 0 && isSearchPage) {\r\n      filtered = filtered.filter(product =>\r\n        tempFilters.categories.includes(product.category_name)\r\n      );\r\n    }\r\n\r\n    if (tempFilters.brands.length > 0) {\r\n      filtered = filtered.filter(product =>\r\n        tempFilters.brands.includes(product.brand_name)\r\n      );\r\n    }\r\n\r\n    if (customPriceFrom !== '' && customPriceTo !== '') {\r\n      const priceFrom = parseFloat(customPriceFrom);\r\n      const priceTo = parseFloat(customPriceTo);\r\n      filtered = filtered.filter(product => {\r\n        const minPrice = getMinPrice(product.store_prices);\r\n        return minPrice >= priceFrom && minPrice <= priceTo;\r\n      });\r\n    } else if (tempFilters.priceRanges.length > 0) {\r\n      filtered = filtered.filter(product => {\r\n        const minPrice = getMinPrice(product.store_prices);\r\n        return tempFilters.priceRanges.some(range => {\r\n          const [min, max] = range.includes('+')\r\n            ? [1000, Infinity]\r\n            : range.split('-').map(Number);\r\n          return minPrice >= min && (max === Infinity || minPrice <= max);\r\n        });\r\n      });\r\n    }\r\n\r\n    if (tempFilters.volumes.length > 0) {\r\n      filtered = filtered.filter(product =>\r\n        tempFilters.volumes.includes(product.volume)\r\n      );\r\n    }\r\n\r\n    if (tempFilters.types.length > 0) {\r\n      filtered = filtered.filter(product =>\r\n        tempFilters.types.includes(product.feature_type)\r\n      );\r\n    }\r\n\r\n    return filtered;\r\n  }, [allProducts, searchQuery, categoryId, isSearchPage, customPriceFrom, customPriceTo]);\r\n\r\n  // Calculate preview product count\r\n  const calculatePreviewProducts = useCallback(() => {\r\n    const filtered = calculateFilteredProducts(selectedFilters);\r\n    return filtered.length;\r\n  }, [calculateFilteredProducts, selectedFilters]);\r\n\r\n  // Update disabled filters\r\n  const updateDisabledFilters = useCallback(() => {\r\n    const newDisabledFilters = {\r\n      brands: new Set(),\r\n      priceRanges: new Set(),\r\n      volumes: new Set(),\r\n      types: new Set(),\r\n      categories: new Set(),\r\n    };\r\n\r\n    const baseFilters = {\r\n      brands: [...selectedFilters.brands],\r\n      priceRanges: [...selectedFilters.priceRanges],\r\n      volumes: [...selectedFilters.volumes],\r\n      types: [...selectedFilters.types],\r\n      categories: [...selectedFilters.categories],\r\n    };\r\n\r\n    filters.brands.forEach(brand => {\r\n      const tempFilters = { ...baseFilters, brands: [brand], priceRanges: baseFilters.priceRanges, volumes: baseFilters.volumes, types: baseFilters.types, categories: baseFilters.categories };\r\n      const filtered = calculateFilteredProducts(tempFilters);\r\n      if (filtered.length === 0) newDisabledFilters.brands.add(brand);\r\n    });\r\n\r\n    filters.priceRanges.forEach(range => {\r\n      const tempFilters = { ...baseFilters, brands: baseFilters.brands, priceRanges: [range.label], volumes: baseFilters.volumes, types: baseFilters.types, categories: baseFilters.categories };\r\n      const filtered = calculateFilteredProducts(tempFilters);\r\n      if (filtered.length === 0) newDisabledFilters.priceRanges.add(range.label);\r\n    });\r\n\r\n    filters.volumes.forEach(volume => {\r\n      const tempFilters = { ...baseFilters, brands: baseFilters.brands, priceRanges: baseFilters.priceRanges, volumes: [volume], types: baseFilters.types, categories: baseFilters.categories };\r\n      const filtered = calculateFilteredProducts(tempFilters);\r\n      if (filtered.length === 0) newDisabledFilters.volumes.add(volume);\r\n    });\r\n\r\n    filters.types.forEach(type => {\r\n      const tempFilters = { ...baseFilters, brands: baseFilters.brands, priceRanges: baseFilters.priceRanges, volumes: baseFilters.volumes, types: [type], categories: baseFilters.categories };\r\n      const filtered = calculateFilteredProducts(tempFilters);\r\n      if (filtered.length === 0) newDisabledFilters.types.add(type);\r\n    });\r\n\r\n    if (isSearchPage) {\r\n      filters.categories.forEach(category => {\r\n        const tempFilters = { ...baseFilters, brands: baseFilters.brands, priceRanges: baseFilters.priceRanges, volumes: baseFilters.volumes, types: baseFilters.types, categories: [category] };\r\n        const filtered = calculateFilteredProducts(tempFilters);\r\n        if (filtered.length === 0) newDisabledFilters.categories.add(category);\r\n      });\r\n    }\r\n\r\n    setDisabledFilters(newDisabledFilters);\r\n  }, [filters, selectedFilters, calculateFilteredProducts, isSearchPage]);\r\n\r\n  // Fetch products and saved statuses\r\n  useEffect(() => {\r\n    console.log('useEffect triggered with dependencies:', {\r\n      categoryId,\r\n      searchQuery,\r\n      initialType,\r\n      isSearchPage,\r\n      user: user ? user.id : null,\r\n      token: token ? 'present' : 'absent',\r\n    });\r\n\r\n    const fetchProducts = async () => {\r\n      setIsLoading(true);\r\n      try {\r\n        const requestParams = {\r\n          search: searchQuery || undefined,\r\n          category: categoryId && !isSearchPage ? categoryId : undefined,\r\n          limit: 1000,\r\n        };\r\n        console.log('Fetching products with params:', requestParams);\r\n\r\n        const productsResponse = await axios.get('https://price-ua-react-backend.onrender.com/products', {\r\n          params: requestParams,\r\n        });\r\n\r\n        console.log('Products API response:', {\r\n          productCount: productsResponse.data.products.length,\r\n          products: productsResponse.data.products.map(p => ({\r\n            id: p.id,\r\n            name: p.name,\r\n            category_id: p.category_id,\r\n            category_name: p.category_name,\r\n          })),\r\n        });\r\n\r\n        let productsData = productsResponse.data.products || [];\r\n        let savedProductIds = [];\r\n        if (user && token && productsData.length > 0) {\r\n          const productIds = productsData.map(p => p.id);\r\n          try {\r\n            const savedResponse = await axios.post(\r\n              'https://price-ua-react-backend.onrender.com/saved-products/bulk',\r\n              { productIds },\r\n              { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            savedProductIds = savedResponse.data.savedProductIds || [];\r\n            console.log('Saved products response:', { savedProductIds });\r\n          } catch (error) {\r\n            console.error('Помилка завантаження статусів збереження:', error);\r\n          }\r\n        }\r\n\r\n        setSavedProducts(new Set(savedProductIds));\r\n\r\n        const brandCounts = {};\r\n        const typeCounts = {};\r\n        const categoryCounts = {};\r\n        const allVolumes = new Set();\r\n        const priceBuckets = new Set();\r\n        productsData.forEach(product => {\r\n          const brand = product.brand_name;\r\n          const type = product.feature_type;\r\n          const category = product.category_name;\r\n          const volume = product.volume;\r\n          const minPrice = getMinPrice(product.store_prices);\r\n          brandCounts[brand] = (brandCounts[brand] || 0) + 1;\r\n          if (type) typeCounts[type] = (typeCounts[type] || 0) + 1;\r\n          categoryCounts[category] = (categoryCounts[category] || 0) + 1;\r\n          if (volume) allVolumes.add(volume);\r\n          if (minPrice > 0) {\r\n            if (minPrice <= 100) priceBuckets.add('0-100');\r\n            else if (minPrice <= 200) priceBuckets.add('100-200');\r\n            else if (minPrice <= 300) priceBuckets.add('200-300');\r\n            else if (minPrice <= 400) priceBuckets.add('300-400');\r\n            else if (minPrice <= 500) priceBuckets.add('400-500');\r\n            else if (minPrice <= 600) priceBuckets.add('500-600');\r\n            else if (minPrice <= 700) priceBuckets.add('600-700');\r\n            else if (minPrice <= 800) priceBuckets.add('700-800');\r\n            else if (minPrice <= 900) priceBuckets.add('800-900');\r\n            else if (minPrice <= 1000) priceBuckets.add('900-1000');\r\n            else priceBuckets.add('1000+');\r\n          }\r\n        });\r\n\r\n        const allBrands = [...new Set(productsData.map(p => p.brand_name))].sort(\r\n          (a, b) => (brandCounts[b] || 0) - (brandCounts[a] || 0)\r\n        );\r\n        const allPriceRanges = [\r\n          { label: '0-100', min: 0, max: 100 },\r\n          { label: '100-200', min: 100, max: 200 },\r\n          { label: '200-300', min: 200, max: 300 },\r\n          { label: '300-400', min: 300, max: 400 },\r\n          { label: '400-500', min: 400, max: 500 },\r\n          { label: '500-600', min: 500, max: 600 },\r\n          { label: '600-700', min: 600, max: 700 },\r\n          { label: '700-800', min: 700, max: 800 },\r\n          { label: '800-900', min: 800, max: 900 },\r\n          { label: '900-1000', min: 900, max: 1000 },\r\n          { label: '1000+', min: 1000, max: Infinity },\r\n        ].filter(range => priceBuckets.has(range.label));\r\n        const allVolumesSorted = [...allVolumes].sort((a, b) => {\r\n          const numA = parseFloat(a.replace(/[^0-9.]/g, '')) || 0;\r\n          const numB = parseFloat(b.replace(/[^0-9.]/g, '')) || 0;\r\n          return numA - numB;\r\n        });\r\n        const allTypes = [...new Set(productsData.map(p => p.feature_type).filter(Boolean))].sort(\r\n          (a, b) => (typeCounts[b] || 0) - (typeCounts[a] || 0)\r\n        );\r\n        const allCategories = isSearchPage\r\n          ? [...new Set(productsData.map(p => p.category_name))].sort(\r\n              (a, b) => (categoryCounts[b] || 0) - (categoryCounts[a] || 0)\r\n            )\r\n          : [categoryId].filter(Boolean);\r\n\r\n        setFilters({\r\n          brands: allBrands,\r\n          priceRanges: allPriceRanges,\r\n          volumes: allVolumesSorted,\r\n          types: allTypes,\r\n          categories: allCategories,\r\n        });\r\n\r\n        setAllProducts(productsData);\r\n        setFilteredProducts(productsData);\r\n        setTotalProducts(productsData.length);\r\n        setPreviewProductCount(productsData.length);\r\n        setCurrentPage(1);\r\n        setStartPage(1);\r\n        setLoadMorePages(1);\r\n        setIsPaginated(true);\r\n\r\n        setSelectedFilters({\r\n          brands: [],\r\n          priceRanges: [],\r\n          volumes: [],\r\n          types: initialType ? [initialType] : [],\r\n          categories: categoryId ? [categoryId] : [],\r\n        });\r\n        setAppliedFilters({\r\n          brands: [],\r\n          priceRanges: [],\r\n          volumes: [],\r\n          types: initialType ? [initialType] : [],\r\n          categories: categoryId ? [categoryId] : [],\r\n        });\r\n\r\n        setBrandSearch('');\r\n        setCustomPriceFrom('');\r\n        setCustomPriceTo('');\r\n\r\n        setDisabledFilters({\r\n          brands: new Set(),\r\n          priceRanges: new Set(),\r\n          volumes: new Set(),\r\n          types: new Set(),\r\n          categories: new Set(),\r\n        });\r\n\r\n        if (initialType) {\r\n          setTimeout(() => {\r\n            const typeCheckbox = document.querySelector(`input[name=\"type\"][value=\"${initialType}\"]`);\r\n            if (typeCheckbox) typeCheckbox.checked = true;\r\n          }, 0);\r\n        }\r\n      } catch (error) {\r\n        console.error('Помилка завантаження продуктів:', error);\r\n        alert('Не вдалося завантажити продукти. Перевірте підключення до сервера.');\r\n        setAllProducts([]);\r\n        setFilteredProducts([]);\r\n        setTotalProducts(0);\r\n        setPreviewProductCount(0);\r\n        setSavedProducts(new Set());\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProducts();\r\n  }, [categoryId, searchQuery, initialType, isSearchPage, token]); // Removed user from dependencies\r\n\r\n  // Update preview count and disabled filters\r\n  useEffect(() => {\r\n    if (!isLoading) {\r\n      setPreviewProductCount(calculatePreviewProducts());\r\n      updateDisabledFilters();\r\n    }\r\n  }, [selectedFilters, customPriceFrom, customPriceTo, isLoading, calculatePreviewProducts, updateDisabledFilters]);\r\n\r\n  // Client-side filtering\r\n  useEffect(() => {\r\n    if (!isLoading && allProducts.length > 0) {\r\n      console.log('Starting client-side filtering:', {\r\n        allProductsCount: allProducts.length,\r\n        searchQuery,\r\n        categoryId,\r\n        isSearchPage,\r\n        appliedFilters,\r\n        customPriceFrom,\r\n        customPriceTo,\r\n      });\r\n\r\n      let filtered = [...allProducts];\r\n\r\n      if (searchQuery) {\r\n        filtered = filtered.filter(product => product.name.toLowerCase().includes(searchQuery.toLowerCase()));\r\n      }\r\n\r\n      if (categoryId && !isSearchPage) {\r\n        filtered = filtered.filter(product => product.category_id === categoryId);\r\n      } else if (appliedFilters.categories.length > 0 && isSearchPage) {\r\n        filtered = filtered.filter(product => appliedFilters.categories.includes(product.category_name));\r\n      }\r\n\r\n      if (appliedFilters.brands.length > 0) {\r\n        filtered = filtered.filter(product => appliedFilters.brands.includes(product.brand_name));\r\n      }\r\n\r\n      if (customPriceFrom !== '' && customPriceTo !== '') {\r\n        const priceFrom = parseFloat(customPriceFrom);\r\n        const priceTo = parseFloat(customPriceTo);\r\n        filtered = filtered.filter(product => {\r\n          const minPrice = getMinPrice(product.store_prices);\r\n          return minPrice >= priceFrom && minPrice <= priceTo;\r\n        });\r\n      } else if (appliedFilters.priceRanges.length > 0) {\r\n        filtered = filtered.filter(product => {\r\n          const minPrice = getMinPrice(product.store_prices);\r\n          return appliedFilters.priceRanges.some(range => {\r\n            const [min, max] = range.includes('+') ? [1000, Infinity] : range.split('-').map(Number);\r\n            return minPrice >= min && (max === Infinity || minPrice <= max);\r\n          });\r\n        });\r\n      }\r\n\r\n      if (appliedFilters.volumes.length > 0) {\r\n        filtered = filtered.filter(product => appliedFilters.volumes.includes(product.volume));\r\n      }\r\n\r\n      if (appliedFilters.types.length > 0) {\r\n        filtered = filtered.filter(product => appliedFilters.types.includes(product.feature_type));\r\n      }\r\n\r\n      setFilteredProducts(filtered);\r\n      setTotalProducts(filtered.length);\r\n    }\r\n  }, [allProducts, appliedFilters, customPriceFrom, customPriceTo, searchQuery, categoryId, isSearchPage, isLoading]);\r\n\r\n  // Handle filter change\r\n  const handleFilterChange = (filterType, value) => {\r\n    setSelectedFilters((prev) => {\r\n      const currentValues = prev[filterType] || [];\r\n      let updatedValues;\r\n      if (currentValues.includes(value)) {\r\n        updatedValues = currentValues.filter((v) => v !== value);\r\n      } else {\r\n        updatedValues = [...currentValues, value];\r\n      }\r\n      const updatedFilters = { ...prev, [filterType]: updatedValues };\r\n      if (filterType === 'priceRanges') {\r\n        setCustomPriceFrom('');\r\n        setCustomPriceTo('');\r\n      }\r\n      return updatedFilters;\r\n    });\r\n    setActiveFilter({ type: filterType, value });\r\n  };\r\n\r\n  // Remove a filter\r\n  const removeFilter = (filterType, value) => {\r\n    setSelectedFilters((prev) => {\r\n      const updatedValues = (prev[filterType] || []).filter((v) => v !== value);\r\n      const updatedFilters = { ...prev, [filterType]: updatedValues };\r\n      setAppliedFilters({ ...prev, [filterType]: updatedValues });\r\n      return updatedFilters;\r\n    });\r\n  };\r\n\r\n  // Reset all filters\r\n  const resetAllFilters = () => {\r\n    const emptyFilters = {\r\n      brands: [],\r\n      priceRanges: [],\r\n      volumes: [],\r\n      types: [],\r\n      categories: [],\r\n    };\r\n    setSelectedFilters(emptyFilters);\r\n    setAppliedFilters(emptyFilters);\r\n    setBrandSearch('');\r\n    setCustomPriceFrom('');\r\n    setCustomPriceTo('');\r\n    setDisabledFilters({\r\n      brands: new Set(),\r\n      priceRanges: new Set(),\r\n      volumes: new Set(),\r\n      types: new Set(),\r\n      categories: new Set(),\r\n    });\r\n    setCurrentPage(1);\r\n    setStartPage(1);\r\n    setLoadMorePages(1);\r\n    setIsPaginated(true);\r\n  };\r\n\r\n  // Apply filters\r\n  const applyFilters = () => {\r\n    setAppliedFilters({ ...selectedFilters });\r\n    setCurrentPage(1);\r\n    setStartPage(1);\r\n    setLoadMorePages(1);\r\n    setIsPaginated(true);\r\n    setActiveFilter(null);\r\n  };\r\n\r\n  // Toggle show more\r\n  const toggleShowMore = (filterType) => {\r\n    setShowMore((prev) => ({ ...prev, [filterType]: !prev[filterType] }));\r\n  };\r\n\r\n  // Handle brand search\r\n  const handleBrandSearch = (e) => {\r\n    setBrandSearch(e.target.value);\r\n  };\r\n\r\n  // Handle custom price change\r\n  const handleCustomPriceChange = (field, value) => {\r\n    const numValue = value.replace(/[^0-9]/g, '');\r\n    if (field === 'from') {\r\n      setCustomPriceFrom(numValue);\r\n    } else {\r\n      setCustomPriceTo(numValue);\r\n    }\r\n    if (numValue !== '') {\r\n      setSelectedFilters((prev) => ({ ...prev, priceRanges: [] }));\r\n      setAppliedFilters((prev) => ({ ...prev, priceRanges: [] }));\r\n    }\r\n  };\r\n\r\n  // Get visible filter items\r\n  const getVisibleItems = useCallback((items, filterType) => {\r\n    if (!items) return [];\r\n\r\n    let filteredItems = items;\r\n\r\n    if (filterType === 'brands') {\r\n      filteredItems = items.filter((brand) =>\r\n        brand.toLowerCase().includes(brandSearch.toLowerCase())\r\n      );\r\n      const topItems = filteredItems.slice(0, 12);\r\n      const remainingItems = filteredItems.slice(12);\r\n      if (showMore.brands || filteredItems.length <= 12) {\r\n        return [...topItems, ...remainingItems.sort((a, b) => a.localeCompare(b))];\r\n      }\r\n      return topItems;\r\n    }\r\n\r\n    if (filterType === 'types') {\r\n      const topItems = filteredItems.slice(0, 6);\r\n      const remainingItems = filteredItems.slice(6);\r\n      if (showMore.types || filteredItems.length <= 6) {\r\n        return [...topItems, ...remainingItems.sort((a, b) => a.localeCompare(b))];\r\n      }\r\n      return topItems;\r\n    }\r\n\r\n    if (filterType === 'categories') {\r\n      if (showMore.categories || items.length <= 6) {\r\n        return [...items].sort((a, b) => a.localeCompare(b));\r\n      }\r\n      return items.slice(0, 6);\r\n    }\r\n\r\n    if (showMore[filterType] || items.length <= 12) {\r\n      return items;\r\n    }\r\n    return items.slice(0, 12);\r\n  }, [brandSearch, showMore]);\r\n\r\n  // Get product name\r\n  const getProductName = (product) => {\r\n    return `${product.name} (${product.volume || 'Об’єм не вказано'})`;\r\n  };\r\n\r\n  // Pagination\r\n  const totalPages = Math.ceil(totalProducts / productsPerPage);\r\n\r\n  const handlePageChange = (page) => {\r\n    setCurrentPage(page);\r\n    setStartPage(page);\r\n    setLoadMorePages(1);\r\n    setIsPaginated(true);\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  };\r\n\r\n  const handleLoadMore = () => {\r\n    setCurrentPage((prev) => prev + 1);\r\n    setLoadMorePages((prev) => prev + 1);\r\n    setIsPaginated(false);\r\n  };\r\n\r\n  const pageNumbers = [];\r\n  for (let i = 1; i <= totalPages; i++) {\r\n    pageNumbers.push(i);\r\n  }\r\n\r\n  const totalAppliedFilters =\r\n    (appliedFilters.brands?.length || 0) +\r\n    (appliedFilters.priceRanges?.length || 0) +\r\n    (appliedFilters.volumes?.length || 0) +\r\n    (appliedFilters.types?.length || 0) +\r\n    (isSearchPage ? (appliedFilters.categories?.length || 0) : 0) +\r\n    (customPriceFrom !== '' && customPriceTo !== '' ? 1 : 0);\r\n\r\n  // Update filter container heights\r\n  useEffect(() => {\r\n    Object.keys(showMore).forEach((filterType) => {\r\n      const container = filterItemsRefs.current[filterType];\r\n      if (container) {\r\n        const items = container.querySelector('.filter-items');\r\n        if (items) {\r\n          const visibleItems = getVisibleItems(filters[filterType], filterType);\r\n          const maxVisible = filterType === 'brands' || filterType === 'priceRanges' || filterType === 'volumes' ? 12 : 6;\r\n          const isExpanded = showMore[filterType] || visibleItems.length <= maxVisible;\r\n          const collapsedHeight = visibleItems.length > maxVisible\r\n            ? items.scrollHeight * (maxVisible / filters[filterType].length)\r\n            : items.scrollHeight;\r\n          container.style.maxHeight = isExpanded\r\n            ? `${items.scrollHeight}px`\r\n            : `${collapsedHeight}px`;\r\n        }\r\n      }\r\n    });\r\n  }, [showMore, filters, brandSearch, getVisibleItems]);\r\n\r\n  return (\r\n    <div className=\"product-list\">\r\n      <h2>Товари категорії</h2>\r\n      {isLoading && (\r\n        <div className=\"loading-overlay\">\r\n          <div className=\"spinner-container\">\r\n            <div className=\"spinner\"></div>\r\n            <p>Завантаження...</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n      <div className=\"product-list-container\">\r\n        <div className={`filters ${!isLoading ? 'loaded' : ''}`}>\r\n          <div className=\"filters-header\">\r\n            <h3>Фільтри</h3>\r\n            {totalAppliedFilters > 0 && (\r\n              <div className=\"selected-filters\">\r\n                {isSearchPage &&\r\n                  appliedFilters.categories?.map((category) => (\r\n                    <div key={`category-${category}`} className=\"selected-filter-tag\">\r\n                      <span>{categoryNames[category] || category}</span>\r\n                      <button onClick={() => removeFilter('categories', category)}>×</button>\r\n                    </div>\r\n                  ))}\r\n                {appliedFilters.brands?.map((brand) => (\r\n                  <div key={`brand-${brand}`} className=\"selected-filter-tag\">\r\n                    <span>{brand}</span>\r\n                    <button onClick={() => removeFilter('brands', brand)}>×</button>\r\n                  </div>\r\n                ))}\r\n                {customPriceFrom !== '' && customPriceTo !== '' ? (\r\n                  <div key=\"custom-price\" className=\"selected-filter-tag\">\r\n                    <span>{customPriceFrom}-{customPriceTo} грн</span>\r\n                    <button onClick={() => { setCustomPriceFrom(''); setCustomPriceTo(''); applyFilters(); }}>×</button>\r\n                  </div>\r\n                ) : (\r\n                  appliedFilters.priceRanges?.map((range) => (\r\n                    <div key={`price-${range}`} className=\"selected-filter-tag\">\r\n                      <span>{range}</span>\r\n                      <button onClick={() => removeFilter('priceRanges', range)}>×</button>\r\n                    </div>\r\n                  ))\r\n                )}\r\n                {appliedFilters.volumes?.map((volume) => (\r\n                  <div key={`volume-${volume}`} className=\"selected-filter-tag\">\r\n                    <span>{volume}</span>\r\n                    <button onClick={() => removeFilter('volumes', volume)}>×</button>\r\n                  </div>\r\n                ))}\r\n                {appliedFilters.types?.map((type) => (\r\n                  <div key={`type-${type}`} className=\"selected-filter-tag\">\r\n                    <span>{type}</span>\r\n                    <button onClick={() => removeFilter('types', type)}>×</button>\r\n                  </div>\r\n                ))}\r\n                {totalAppliedFilters > 1 && (\r\n                  <button className=\"reset-all-filters\" onClick={resetAllFilters}>Скинути всі</button>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {isSearchPage && searchQuery && (\r\n            <div className=\"filter-section\">\r\n              <h4>Категорія</h4>\r\n              <div className=\"filter-items-container\" ref={(el) => (filterItemsRefs.current['categories'] = el)}>\r\n                <div className=\"filter-items filter-items-single-column\">\r\n                  {getVisibleItems(filters.categories, 'categories').map((category, index) => {\r\n                    const isDisabled = disabledFilters.categories.has(category);\r\n                    return (\r\n                      <label key={index} className={isDisabled ? 'disabled' : ''} ref={(el) => (filterRefs.current[`categories-${category}`] = el)}>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          name=\"category\"\r\n                          value={category}\r\n                          checked={selectedFilters.categories?.includes(category) || false}\r\n                          onChange={() => handleFilterChange('categories', category)}\r\n                          disabled={isDisabled}\r\n                        />\r\n                        {categoryNames[category] || category}\r\n                      </label>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n              {filters.categories.length > 6 && (\r\n                <button className=\"show-more-btn\" onClick={() => toggleShowMore('categories')}>\r\n                  {showMore.categories ? 'Менше ↑' : 'Більше ↓'}\r\n                </button>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"filter-section\">\r\n            <h4>Бренд</h4>\r\n            <input\r\n              type=\"text\"\r\n              className=\"brand-search-input\"\r\n              placeholder=\"Пошук бренду...\"\r\n              value={brandSearch}\r\n              onChange={handleBrandSearch}\r\n            />\r\n            <div className=\"filter-items-container\" ref={(el) => (filterItemsRefs.current['brands'] = el)}>\r\n              <div className=\"filter-items\">\r\n                {getVisibleItems(filters.brands, 'brands').map((brand, index) => {\r\n                  const isDisabled = disabledFilters.brands.has(brand);\r\n                  return (\r\n                    <label\r\n                      key={index}\r\n                      className={`${brand.length > 13 ? 'span-two-columns' : ''} ${isDisabled ? 'disabled' : ''}`}\r\n                      ref={(el) => (filterRefs.current[`brands-${brand}`] = el)}\r\n                    >\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        name=\"brand\"\r\n                        value={brand}\r\n                        checked={selectedFilters.brands?.includes(brand) || false}\r\n                        onChange={() => handleFilterChange('brands', brand)}\r\n                        disabled={isDisabled}\r\n                      />\r\n                      {brand}\r\n                    </label>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n            {filters.brands.length > 12 && (\r\n              <button className=\"show-more-btn\" onClick={() => toggleShowMore('brands')}>\r\n                {showMore.brands ? 'Менше ↑' : 'Більше ↓'}\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"filter-section\">\r\n            <h4>Ціна (грн)</h4>\r\n            <div className=\"custom-price-inputs\">\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Від\"\r\n                value={customPriceFrom}\r\n                onChange={(e) => handleCustomPriceChange('from', e.target.value)}\r\n                className=\"price-input\"\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"До\"\r\n                value={customPriceTo}\r\n                onChange={(e) => handleCustomPriceChange('to', e.target.value)}\r\n                className=\"price-input\"\r\n              />\r\n            </div>\r\n            <div className=\"filter-items-container\" ref={(el) => (filterItemsRefs.current['priceRanges'] = el)}>\r\n              <div className=\"filter-items\">\r\n                {getVisibleItems(filters.priceRanges, 'priceRanges').map((range, index) => {\r\n                  const isDisabled = disabledFilters.priceRanges.has(range.label);\r\n                  return (\r\n                    <label key={index} className={isDisabled ? 'disabled' : ''} ref={(el) => (filterRefs.current[`priceRanges-${range.label}`] = el)}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        name=\"priceRange\"\r\n                        value={range.label}\r\n                        checked={selectedFilters.priceRanges?.includes(range.label) || false}\r\n                        onChange={() => handleFilterChange('priceRanges', range.label)}\r\n                        disabled={isDisabled}\r\n                      />\r\n                      {range.label}\r\n                    </label>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n            {filters.priceRanges.length > 12 && (\r\n              <button className=\"show-more-btn\" onClick={() => toggleShowMore('priceRanges')}>\r\n                {showMore.priceRanges ? 'Менше ↑' : 'Більше ↓'}\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"filter-section\">\r\n            <h4>Об’єм</h4>\r\n            <div className=\"filter-items-container\" ref={(el) => (filterItemsRefs.current['volumes'] = el)}>\r\n              <div className=\"filter-items\">\r\n                {getVisibleItems(filters.volumes, 'volumes').map((volume, index) => {\r\n                  const isDisabled = disabledFilters.volumes.has(volume);\r\n                  return (\r\n                    <label key={index} className={isDisabled ? 'disabled' : ''} ref={(el) => (filterRefs.current[`volumes-${volume}`] = el)}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        name=\"volume\"\r\n                        value={volume}\r\n                        checked={selectedFilters.volumes?.includes(volume) || false}\r\n                        onChange={() => handleFilterChange('volumes', volume)}\r\n                        disabled={isDisabled}\r\n                      />\r\n                      {volume}\r\n                    </label>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n            {filters.volumes.length > 12 && (\r\n              <button className=\"show-more-btn\" onClick={() => toggleShowMore('volumes')}>\r\n                {showMore.volumes ? 'Менше ↑' : 'Більше ↓'}\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"filter-section\">\r\n            <h4>Тип</h4>\r\n            <div className=\"filter-items-container\" ref={(el) => (filterItemsRefs.current['types'] = el)}>\r\n              <div className=\"filter-items filter-items-single-column\">\r\n                {getVisibleItems(filters.types, 'types').map((type, index) => {\r\n                  const isDisabled = disabledFilters.types.has(type);\r\n                  return (\r\n                    <label key={index} className={isDisabled ? 'disabled' : ''} ref={(el) => (filterRefs.current[`types-${type}`] = el)}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        name=\"type\"\r\n                        value={type}\r\n                        checked={selectedFilters.types?.includes(type) || false}\r\n                        onChange={() => handleFilterChange('types', type)}\r\n                        disabled={isDisabled}\r\n                      />\r\n                      {type}\r\n                    </label>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n            {filters.types.length > 6 && (\r\n              <button className=\"show-more-btn\" onClick={() => toggleShowMore('types')}>\r\n                {showMore.types ? 'Менше ↑' : 'Більше ↓'}\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {activeFilter && (\r\n            <button\r\n              className=\"filter-tag\"\r\n              ref={tagRef}\r\n              onClick={applyFilters}\r\n              style={{\r\n                top: filterRefs.current[`${activeFilter.type}-${activeFilter.value}`]\r\n                  ? `${\r\n                      filterRefs.current[`${activeFilter.type}-${activeFilter.value}`].getBoundingClientRect().top -\r\n                      filterRefs.current[`${activeFilter.type}-${activeFilter.value}`].closest('.filters').getBoundingClientRect().top +\r\n                      filterRefs.current[`${activeFilter.type}-${activeFilter.value}`].offsetHeight / 2\r\n                    }px`\r\n                  : '0px',\r\n              }}\r\n            >\r\n              Показати товари ({previewProductCount})\r\n            </button>\r\n          )}\r\n\r\n          <button className=\"apply-filters-btn\" onClick={applyFilters}>\r\n            Показати товари ({previewProductCount})\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"products\">\r\n          <div className={`products-list ${!isLoading ? 'loaded' : ''}`}>\r\n            {filteredProducts.length > 0 ? (\r\n              filteredProducts\r\n                .slice(\r\n                  isPaginated ? (currentPage - 1) * productsPerPage : (startPage - 1) * productsPerPage,\r\n                  isPaginated ? currentPage * productsPerPage : startPage * productsPerPage + loadMorePages * productsPerPage\r\n                )\r\n                .map((product, index) => (\r\n                  <div key={`${product.id}-${index}`} className=\"product-card-container\">\r\n                    <Link to={`/product/${product.id}`} className=\"product-card\">\r\n                      <h3>{getProductName(product)}</h3>\r\n                      <img\r\n                        src={product.images && product.images.length > 0 ? product.images[0] : '/img/placeholder.webp'}\r\n                        alt={product.name}\r\n                        onError={(e) => (e.target.src = '/img/placeholder.webp')}\r\n                      />\r\n                      <p className=\"price\">{getMinPrice(product.store_prices)} грн</p>\r\n                      <p>{product.description || 'Опис відсутній'}</p>\r\n                    </Link>\r\n                    <div\r\n                      className={`heart-icon ${savedProducts.has(product.id) ? 'saved' : ''}`}\r\n                      onClick={(e) => handleHeartClick(product.id, e)}\r\n                    >\r\n                      <svg\r\n                        xmlns=\"http://www.w3.org/2000/svg\"\r\n                        width=\"24\"\r\n                        height=\"24\"\r\n                        viewBox=\"0 0 24 24\"\r\n                        fill={savedProducts.has(product.id) ? '#d32f2f' : 'none'}\r\n                        stroke=\"#d32f2f\"\r\n                        strokeWidth=\"2\"\r\n                        strokeLinecap=\"round\"\r\n                        strokeLinejoin=\"round\"\r\n                      >\r\n                        <path d=\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z\"></path>\r\n                      </svg>\r\n                    </div>\r\n                    {showLoginPrompt[product.id] && (\r\n                      <div className=\"login-prompt\">\r\n                        Увійдіть в <Link to=\"/login\" className=\"login-link\">аккаунт</Link> щоб додати до бажаного\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))\r\n            ) : (\r\n              !isLoading && <p>Товари не знайдено</p>\r\n            )}\r\n          </div>\r\n          {!isLoading && totalProducts > productsPerPage && (\r\n            <div className=\"pagination-container\">\r\n              {((startPage - 1 + loadMorePages) * productsPerPage) < totalProducts && (\r\n                <button className=\"load-more-btn\" onClick={handleLoadMore}>Завантажити ще</button>\r\n              )}\r\n              <div className=\"pagination\">\r\n                <button\r\n                  className=\"pagination-btn\"\r\n                  onClick={() => handlePageChange(currentPage - 1)}\r\n                  disabled={currentPage === 1}\r\n                >\r\n                  Попередня\r\n                </button>\r\n                {pageNumbers.map((number) => (\r\n                  <button\r\n                    key={number}\r\n                    className={`pagination-btn ${currentPage === number ? 'active' : ''}`}\r\n                    onClick={() => handlePageChange(number)}\r\n                  >\r\n                    {number}\r\n                  </button>\r\n                ))}\r\n                <button\r\n                  className=\"pagination-btn\"\r\n                  onClick={() => handlePageChange(currentPage + 1)}\r\n                  disabled={currentPage === totalPages}\r\n                >\r\n                  Наступна\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProductList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}